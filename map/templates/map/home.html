{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Advanced GIS Portal</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@9.1.0/ol.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.1/dist/ol-layerswitcher.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="{% static 'map/css/map.css' %}">
</head>

<body>
  <div id="map"></div>

  <div class="map-tools">
    <button id="measureDistBtn" class="btn btn-sm btn-light" title="Measure Distance">
      <i class="fas fa-ruler-horizontal"></i>
    </button>
    <button id="measureAreaBtn" class="btn btn-sm btn-light" title="Measure Area">
      <i class="fas fa-ruler-combined"></i>
    </button>
    <button id="drawPolyBtn" class="btn btn-sm btn-light" title="Draw Polygon">
      <i class="fas fa-draw-polygon"></i>
    </button>
    <button id="clearDrawingsBtn" class="btn btn-sm btn-danger" title="Clear Drawings">
      <i class="fas fa-trash-alt"></i>
    </button>
  </div>

  <div class="data-panel">
    <label for="taluka">Select Taluka:</label>
    <select id="taluka" class="form-select form-select-sm">
      <option disabled selected>Loading…</option>
    </select>

    <label for="village" class="mt-2">Select Village:</label>
    <select id="village" class="form-select form-select-sm" disabled>
      <option disabled selected>—</option>
    </select>

    <hr>

    <label for="searchInput">Search by Name:</label>
    <input type="text" id="searchInput" class="form-control form-control-sm" placeholder="Search Village Name...">
    <button id="searchButton" class="btn btn-primary btn-sm w-100 mt-1">Search</button>
    <div id="searchResults" class="mt-2"
      style="max-height: 120px; overflow-y: auto; border-top: 1px solid #eee; padding-top: 5px;">
    </div>
  </div>

  <div class="logout-button-container">
    <a href="{% url 'logout' %}" class="btn btn-logout">Logout</a>
  </div>

  <div id="popup" class="ol-popup">
    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
    <div id="popup-content"></div>
  </div>

  <div class="modal fade" id="cropDetailsModal" tabindex="-1" aria-labelledby="cropDetailsModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="cropDetailsModalLabel">Add Crop Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="cropDetailsForm">
            <div class="mb-3">
              <label for="cropSeason" class="form-label">Season</label>
              <select class="form-select" id="cropSeason" required>
                <option value="">Select Season</option>
                <option value="Kharif">Kharif (Monsoon Season)</option>
                <option value="Rabi">Rabi (Winter Season)</option>
                <option value="Zaid">Zaid (Summer Season)</option>
                <option value="Horticulture">Horticulture (Year-Round/Seasonal)</option>
              </select>
            </div>
            <div class="mb-3" id="cropTypeGroup" style="display: none;">
              <label for="cropType" class="form-label">Crop Type</label>
              <select class="form-select" id="cropType" required disabled>
                <option value="">Select Crop Type</option>
              </select>
            </div>
            <div class="mb-3" id="specificCropGroup" style="display: none;">
              <label for="specificCrop" class="form-label">Specific Crop</label>
              <select class="form-select" id="specificCrop" required disabled>
                <option value="">Select Specific Crop</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="sowingDate" class="form-label">Sowing Date</label>
              <input type="date" class="form-control" id="sowingDate">
            </div>
            <div class="mb-3">
              <label for="cropNotes" class="form-label">Notes</label>
              <textarea type="text" class="form-control" id="cropNotes" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" id="discardPolygonBtn" class="btn btn-danger">Discard Polygon</button>
          <button type="button" id="saveCropDetailsBtn" class="btn btn-primary">Save Details</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/ol@9.1.0/dist/ol.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ol-layerswitcher@4.1.1/dist/ol-layerswitcher.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="{% static 'map/js/map.js' %}"></script>
</body>

</html>
